<!DOCTYPE html>
<html>

    <head>
        <title>GPA calculator</title>
        <link href="styles.css" rel="stylesheet">

    </head>
    <body>

        
        
        
        <div id="inter">
            <div id="h1"><h1>GPA Calculator</h1></div><br><hr class="solid">
            <p id="up"></p>
        <div id="inter-inputs">
            
            Subject: <select name="cradit" id="credit">
                <option value="3">IT11013 : IT and Computing Fundamentals</option>
                <option value="3">IT11023 : Programming Fundamentals</option>
                <option value="3">IT11033 : Discrete Mathematics</option>
                <option value="1">IT11041 : Psychology</option>
                <option value="2">IT11052 : Leadership and Communication Skills</option>
                <option value="3">BMG11073 : Entreprenureship and Growing Business</option>
                <option value="2">IT12012 : Computer Organization & Architecture</option>
                <option value="3">IT12023 : Information Management</option>
                <option value="3">IT12063 : Data Structure and Algorithems I</option>
                <option value="3">IT12043 : Integrative Programming & Technologies</option>
                <option value="2">IT12052 : Emerging Technologies</option>
                <option value="1">IT12031 : Seminar I</option>
                <option value="3">IT21053 : Object Oriented Programming</option>
                <option value="2">IT21012 : Social and Professional Issues</option>
                <option value="2">IT21022 : Data Communication</option>
                <option value="2">IT21032 : Software Design and Implementation</option>
                <option value="3">IT21043 : Software Construction Technologies</option>
                <option value="3">IT21063 : Data Structure and Algorithems II</option>
                <option value="2">IT21072 : System Analysis and Design</option>

        </select>
        
            Grade: <select name="grade" id="grade">
                <option value="4">A+</option>
                <option value="4">A</option>
                <option value="3.7">A-</option>
                <option value="3.3">B+</option>
                <option value="3">B</option>
                <option value="2.7">B-</option>
                <option value="2.3">C+</option>
                <option value="2">C</option>
                <option value="1.7">C-</option>
                <option value="1.3">D+</option>
                <option value="1">D</option>
                <option value="0">F</option>
        </select>

        <button onclick="sum()">Add</button>
    </div> 
    </div>
    
        <div id="table-space">
            <table id="subTable">
            
            </table>
        </div>
          <br>

        
        <div id="inter-bottom">
            <div><p id="gpa"></p></div>
        <button onclick="removeRow()">Remove</button>
        <button onclick="calc()">Calculate GPA</button>
        <button onclick="reset()">Reset</button>
        <button onclick="fnExcelReport()" id="print">Print</button>
        
        
    </div>

    </body>

</html>

<script>
    document.getElementById("print").disabled = true;
    document.getElementById("print").style.backgroundColor = "#747577";
    i=0;
    j=0;
    k=0;
    gpa = 0;
    var table = document.getElementById("subTable");
    var row = table.insertRow(i);
  var cell1 = row.insertCell(0);
  var cell2 = row.insertCell(1);
  var cell3 = row.insertCell(2);
  var cell4 = row.insertCell(3);

  cell1.innerHTML = "Subject";
  cell2.innerHTML = "Credit";
  cell3.innerHTML = "Grade";
  cell4.innerHTML = "Grade Score";

    subSum = 0;
    totalCred = 0;
function sum(){
subject = document.getElementById("credit").options[document.getElementById("credit").selectedIndex].text;
credit = parseInt(document.getElementById("credit").value);
grade = document.getElementById("grade").options[document.getElementById("grade").selectedIndex].text;
gradeScore = document.getElementById("grade").value;
subSum += credit*gradeScore;
totalCred = totalCred+credit;
//document.getElementById("up").innerText = subSum+" "+totalCred;

i++;
  var row = table.insertRow(i);
  var cell1 = row.insertCell(0);
  var cell2 = row.insertCell(1);
  var cell3 = row.insertCell(2);
  var cell4 = row.insertCell(3);

  cell1.innerHTML = subject;
  cell2.innerHTML = credit;
  cell3.innerHTML = grade;
  cell4.innerHTML = gradeScore;
  j++;
  document.getElementById("credit").selectedIndex = j;
  
    
}
function calc(){
    gpa = subSum/totalCred;
    document.getElementById("gpa").innerHTML = "Your G.P.A is : "+gpa.toFixed(2);
    document.getElementById("print").disabled = false;
    document.getElementById("print").style.backgroundColor = "#576c9e";
    
}

function removeRow(){
    
    if(i>0){
        removeVal = table.rows[i].cells[1].innerHTML*table.rows[i].cells[2].innerHTML;
    subSum = subSum-removeVal;
    totalCred = totalCred - parseInt(table.rows[i].cells[1].innerHTML);
    table.deleteRow(i);
    i--;
    j--;
    
    if(k<1){
        j--;
    }
    k++;
    document.getElementById("credit").selectedIndex = j;
    
    }
    //document.getElementById("up").innerText = subSum+" "+totalCred;
}
function reset(){
    window.location.reload();
}

function exportTableToExcel() {


        

        /*var downloadLink;
        var dataType = 'application/vnd.ms-excel';
        var tableSelect = document.getElementById("subTable");
        var tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');

        // Specify file name
        filename = "G.P.A" + '.xls';

        // Create download link element
        downloadLink = document.createElement("a");

        document.body.appendChild(downloadLink);

        if (navigator.msSaveOrOpenBlob) {
            var blob = new Blob(['\ufeff', tableHTML], {
                type: dataType
            });
            navigator.msSaveOrOpenBlob(blob, filename);
        } else {
            // Create a link to the file
            downloadLink.href = 'data:' + dataType + ', ' + tableHTML;
            // Setting the file name
            downloadLink.download = filename;

            //triggering the function
            downloadLink.click();
        }*/
        

        
    }

    function fnExcelReport()
{

    i++;
        var table = document.getElementById("subTable");

        var row = table.insertRow(i);
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);

        cell1.innerHTML = "Total Credits Score";
        cell2.innerHTML = "-";
        cell3.innerHTML = "-";
        cell4.innerHTML = totalCred;

        var row1 = table.insertRow(i+1);
        var cell11 = row1.insertCell(0);
        var cell12 = row1.insertCell(1);
        var cell13 = row1.insertCell(2);
        var cell14 = row1.insertCell(3);

        cell11.innerHTML = "";
        cell12.innerHTML = "";
        cell13.innerHTML = "";
        cell14.innerHTML = "";

        var row2 = table.insertRow(i+2);
        var cell21 = row2.insertCell(0);
        var cell22 = row2.insertCell(1);
        var cell23 = row2.insertCell(2);
        var cell24 = row2.insertCell(3);

        cell21.innerHTML = "Your GPA is :";
        cell22.innerHTML = "";
        cell23.innerHTML = "";
        cell24.innerHTML = gpa;

    var tab_text="<table border='1px'><tr bgcolor='#87AFC6'>";
    var textRange; var j=0;
    tab = document.getElementById('subTable'); // id of table

    for(j = 0 ; j < tab.rows.length ; j++) 
    {     
        tab_text=tab_text+tab.rows[j].innerHTML+"</tr>";
        //tab_text=tab_text+"</tr>";
    }

    tab_text=tab_text+"</table>";
    tab_text= tab_text.replace(/<A[^>]*>|<\/A>/g, "");//remove if u want links in your table
    tab_text= tab_text.replace(/<img[^>]*>/gi,""); // remove if u want images in your table
    tab_text= tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

    var ua = window.navigator.userAgent;
    var msie = ua.indexOf("MSIE "); 

    if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // If Internet Explorer
    {
        txtArea1.document.open("txt/html","replace");
        txtArea1.document.write(tab_text);
        txtArea1.document.close();
        txtArea1.focus(); 
        sa=txtArea1.document.execCommand("SaveAs",true,"Say Thanks to Sumit.xls");
    }  
    else                 //other browser not tested on IE 11
        sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));  

        table.deleteRow(i);
        i--;
    return (sa);
}
</script>
